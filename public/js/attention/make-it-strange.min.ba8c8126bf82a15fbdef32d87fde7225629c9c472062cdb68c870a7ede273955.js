(function(){function t(e){for(let t=0;t<e.length;t+=4){const n=e[t],s=e[t+1],o=e[t+2],i=.2126*n+.7152*s+.0722*o|0;e[t]=e[t+1]=e[t+2]=i}}function n(e,t){const n=255/(t-1);for(let t=0;t<e.length;t+=4)e[t]=Math.round(e[t]/n)*n,e[t+1]=Math.round(e[t+1]/n)*n,e[t+2]=Math.round(e[t+2]/n)*n}function s(e,t){const i=e.width,a=e.height,n=e.data,o=t.data,s=new Uint8ClampedArray(n.length);for(let e=0;e<n.length;e+=4){const t=.2126*n[e]+.7152*n[e+1]+.0722*n[e+2]|0;s[e]=s[e+1]=s[e+2]=t,s[e+3]=255}const r=[-1,0,1,-2,0,2,-1,0,1],c=[-1,-2,-1,0,0,0,1,2,1];function l(e,t){return s[t*i+e<<2]}for(let e=1;e<a-1;e++)for(let t=1;t<i-1;t++){let a=0,d=0,s=0;for(let n=-1;n<=1;n++)for(let o=-1;o<=1;o++){const i=l(t+o,e+n);a+=i*r[s],d+=i*c[s],s++}const u=Math.min(255,Math.hypot(a,d)|0),n=e*i+t<<2;o[n]=o[n+1]=o[n+2]=u,o[n+3]=255}}function e(e){const r=e.querySelector(".mis-img"),o=e.querySelector(".mis-canvas"),d=e.querySelector(".mis-mode"),u=e.querySelector(".mis-int"),a=o.getContext("2d",{willReadFrequently:!0}),c=d.value,h=Math.min(1200,r.naturalWidth),l=Math.min(1,h/r.naturalWidth);if(o.width=r.naturalWidth*l|0,o.height=r.naturalHeight*l|0,a.drawImage(r,0,0,o.width,o.height),c==="original")return;let i=a.getImageData(0,0,o.width,o.height);if(c==="value")t(i.data),a.putImageData(i,0,0);else if(c==="posterize"){const e=Math.max(2,parseInt(u.value,10));n(i.data,e),a.putImageData(i,0,0)}else if(c==="edges"){const e=a.createImageData(i.width,i.height);s(i,e),a.putImageData(e,0,0)}}function o(t){const s=t.dataset.src,n=t.querySelector(".mis-img");n.addEventListener("load",()=>e(t)),t.querySelector(".mis-mode").addEventListener("change",()=>e(t)),t.querySelector(".mis-int").addEventListener("input",()=>e(t)),n.complete?e(t):n.src=s}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".mis").forEach(o)})})()