(function(){function e(e,t){const n=(t-90)*Math.PI/180;return[180+e*Math.cos(n),180+e*Math.sin(n)]}function n(t,n,s,o){const[a,r]=e(n,s),[c,l]=e(n,o),[d,u]=e(t,o),[h,m]=e(t,s),i=o-s>180?1:0;return`M ${a} ${r} A ${n} ${n} 0 ${i} 1 ${c} ${l} L ${d} ${u} A ${t} ${t} 0 ${i} 0 ${h} ${m} Z`}const t=e=>(e%360+360)%360;function s(s){const o=s.dataset.src||"art-elements.json";fetch(o).then(e=>e.json()).then(o=>{const c=o.items||[],r=s.querySelector("svg.wheel"),u=s.querySelector("#wheel"),i=360/c.length,g=60,j=170;u.innerHTML="",c.forEach((t,s)=>{const r=s*i,c=(s+1)*i,a=document.createElementNS("http://www.w3.org/2000/svg","path");a.setAttribute("d",n(g,j,r,c)),a.setAttribute("fill","rgba(0,0,0,0.08)"),a.setAttribute("stroke","#bbb"),a.dataset.index=s,a.addEventListener("click",()=>x(s)),u.appendChild(a);const l=r+i/2,[d,h]=e((g+j)/2,l),o=document.createElementNS("http://www.w3.org/2000/svg","text");o.setAttribute("x",d),o.setAttribute("y",h),o.setAttribute("text-anchor","middle"),o.setAttribute("dominant-baseline","middle"),o.setAttribute("font-size","12"),o.textContent=t.title,u.appendChild(o)});const O=s.querySelector(".aw-title"),A=s.querySelector(".aw-desc"),k=s.querySelector(".aw-prompt em");let a=0;function l(e){a=e,u.setAttribute("transform",`rotate(${a} 180 180)`),C()}function E(){const e=Math.round(-a/i);return(e%c.length+c.length)%c.length}function C(){const e=c[E()];if(!e)return;O.textContent=e.title,A.textContent=e.desc,k.textContent=e.prompt}s.querySelector(".aw-left").addEventListener("click",()=>m(-1)),s.querySelector(".aw-right").addEventListener("click",()=>m(+1)),s.addEventListener("keydown",e=>{e.key==="ArrowLeft"&&(e.preventDefault(),m(-1)),e.key==="ArrowRight"&&(e.preventDefault(),m(+1))});function m(e){y(a+e*i)}function x(e){y(-e*i)}function y(e){const o=a;let n=t(e)-t(o);n>180&&(n-=360),n<-180&&(n+=360);const c=300;let s=null;function r(e){s||(s=e);const t=Math.min(1,(e-s)/c),d=1-(1-t)**3;l(o+n*d),t<1?requestAnimationFrame(r):l(Math.round(a/i)*i)}requestAnimationFrame(r)}let h=!1,w=0,_=0,f=0,p=0,d=0;function v(e){const n=r.getBoundingClientRect();w=n.left+n.width/2,_=n.top+n.height/2;const s=Math.atan2(e.clientY-_,e.clientX-w)*180/Math.PI+90;return t(s)}r.addEventListener("pointerdown",e=>{e.preventDefault(),h=!0,r.setPointerCapture(e.pointerId),f=v(e),p=e.timeStamp,d=0,document.body.style.overflow="hidden",document.documentElement.style.overflow="hidden",document.body.style.userSelect="none"}),r.addEventListener("pointermove",e=>{if(!h)return;const n=v(e);let t=n-f;t>180&&(t-=360),t<-180&&(t+=360),l(a+t);const s=e.timeStamp-p;if(s>0){const e=t/s*1e3;d=.8*d+.2*e}f=n,p=e.timeStamp});function b(e){if(!h)return;h=!1;try{r.releasePointerCapture(e.pointerId)}catch{}let t=d;const s=.95;function n(){if((t<0?-t:t)<5){l(Math.round(a/i)*i);return}l(a+t/60),t*=s,requestAnimationFrame(n)}requestAnimationFrame(n)}r.addEventListener("pointerup",b),r.addEventListener("pointercancel",b),l(0)})}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".artwheel").forEach(s)})})()